---
title: "1. Rust åŸºç¡€è¯­æ³•"
date: 2025-03-29T01:01:43+08:00
updated: 2025-03-29T09:59:21+08:00
---

# 1. Rust åŸºç¡€è¯­æ³•

## 1.1 å˜é‡ä¸å¯å˜æ€§

```rust
let x = 5;          // ä¸å¯å˜ç»‘å®š
let mut y = 10;     // å¯å˜ç»‘å®š
const MAX_POINTS: u32 = 100_000; // å¸¸é‡
```

- Rust å˜é‡é»˜è®¤ä¸å¯å˜ï¼Œéœ€è¦æ˜¾å¼å£°æ˜ `mut` ä½¿å…¶å¯å˜
- å¸¸é‡å¿…é¡»æ˜¾å¼æ ‡æ³¨ç±»å‹ï¼Œå‘½åæƒ¯ä¾‹æ˜¯å…¨å¤§å†™åŠ ä¸‹åˆ’çº¿
- å¯ä»¥ä½¿ç”¨ `let` å…³é”®å­—é‡æ–°å£°æ˜åŒåå˜é‡ï¼Œè¿™è¢«ç§°ä¸º"é®è”½"(Shadowing)

```rust
let x = 5;
let x = x + 1;    // x ç°åœ¨æ˜¯ 6
let x = x * 2;    // x ç°åœ¨æ˜¯ 12
```

### å˜é‡é®è”½ä¸å¯å˜æ€§çš„åŒºåˆ«

- ä½¿ç”¨ `let` åˆ›å»ºçš„æ–°å˜é‡å¯ä»¥æ”¹å˜ç±»å‹ï¼Œè€Œ `mut` ä¸è¡Œ
- é®è”½å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°å˜é‡ï¼Œåªæ˜¯å¤ç”¨äº†åŒæ ·çš„åç§°

```rust
let spaces = "   ";       // å­—ç¬¦ä¸²ç±»å‹
let spaces = spaces.len(); // æ•°å€¼ç±»å‹ - æœ‰æ•ˆ

// ä¸ä¹‹ç›¸å¯¹çš„:
let mut spaces = "   ";
spaces = spaces.len();    // ç±»å‹ä¸åŒ - é”™è¯¯!
```

## 1.2 æ•°æ®ç±»å‹

Rust æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚ç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ ¹æ®å€¼å’Œä½¿ç”¨æ–¹å¼æ¨æ–­ç±»å‹ã€‚

### æ ‡é‡ç±»å‹

#### æ•´æ•°ç±»å‹

```rust
let a: i32 = -42;       // æœ‰ç¬¦å·æ•´æ•°
let b: u32 = 42;        // æ— ç¬¦å·æ•´æ•°
let c: i32 = 0xff;      // åå…­è¿›åˆ¶
let d: i32 = 0o77;      // å…«è¿›åˆ¶
let e: i32 = 0b1111_0000; // äºŒè¿›åˆ¶
let f: u8 = b'A';       // å­—èŠ‚(ä»…é™u8)
```

#### æµ®ç‚¹ç±»å‹

```rust
let x = 2.0;      // f64 (é»˜è®¤)
let y: f32 = 3.0; // f32
```

#### å¸ƒå°”ç±»å‹

```rust
let t = true;
let f: bool = false;
```

#### å­—ç¬¦ç±»å‹

```rust
let c = 'z';
let z = 'â„¤';     // Unicodeå­—ç¬¦
let heart_eyed_cat = 'ğŸ˜»'; // Unicodeè¡¨æƒ…
```

### å¤åˆç±»å‹

#### å…ƒç»„

```rust
// å…ƒç»„
let tup: (i32, f64, u8) = (500, 6.4, 1);
let (x, y, z) = tup;    // è§£æ„
let five_hundred = tup.0; // ç‚¹å·è®¿é—®

// å•å…ƒå…ƒç»„
let unit = ();  // ç©ºå…ƒç»„ï¼Œä¹Ÿç§°ä¸ºå•å…ƒç±»å‹
```

#### æ•°ç»„

```rust
// æ•°ç»„ - å›ºå®šé•¿åº¦ï¼Œå…ƒç´ ç±»å‹ç›¸åŒ
let arr = [1, 2, 3, 4, 5];
let first = arr[0];     // ç´¢å¼•è®¿é—®
let arr_type: [i32; 5] = [1, 2, 3, 4, 5]; // æ˜¾å¼ç±»å‹
let arr_same = [3; 5];  // [3, 3, 3, 3, 3]
```

**æ³¨æ„**ï¼šæ•°ç»„è®¿é—®è¶Šç•Œä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼ˆpanicï¼‰ï¼Œè¿™ä¸ä¸€äº›è¯­è¨€å…è®¸è¶Šç•Œä¸åŒã€‚

## 1.3 å‡½æ•°

```rust
fn add(x: i32, y: i32) -> i32 {
    x + y  // æ— åˆ†å·ï¼Œä½œä¸ºè¿”å›å€¼
}

fn print_hello() {
    println!("Hello, world!");
}

// å…·æœ‰å¤æ‚é€»è¾‘çš„å‡½æ•°
fn calculate_length(s: String) -> (String, usize) {
    let length = s.len(); // è·å–å­—ç¬¦ä¸²é•¿åº¦
    (s, length) // è¿”å›å…ƒç»„ï¼ŒåŒ…å«å­—ç¬¦ä¸²å’Œé•¿åº¦
}
```

- å‚æ•°å¿…é¡»æ˜¾å¼æ ‡æ³¨ç±»å‹
- è¿”å›å€¼ä½¿ç”¨ `->` æŒ‡å®šç±»å‹
- æœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆæ²¡æœ‰åˆ†å·ï¼‰è‡ªåŠ¨ä½œä¸ºè¿”å›å€¼ï¼Œæˆ–ç”¨ `return` æ˜¾å¼è¿”å›
- Rust çš„å‡½æ•°å’Œè¯­å¥éµå¾ª"è›‡å½¢å‘½å"(snake_case)ï¼šå°å†™å­—æ¯åŠ ä¸‹åˆ’çº¿

### è¯­å¥ä¸è¡¨è¾¾å¼

Rust æ˜¯ä¸€ç§åŸºäºè¡¨è¾¾å¼çš„è¯­è¨€ï¼š

- **è¯­å¥**ï¼šæ‰§è¡Œæ“ä½œä½†ä¸è¿”å›å€¼
- **è¡¨è¾¾å¼**ï¼šè®¡ç®—å¹¶äº§ç”Ÿä¸€ä¸ªå€¼

```rust
// è¯­å¥
let y = 6; // æ²¡æœ‰è¿”å›å€¼

// è¡¨è¾¾å¼
let y = {
    let x = 3;
    x + 1  // æ³¨æ„æ²¡æœ‰åˆ†å·ï¼Œè¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼
};  // y = 4
```

## 1.4 æ§åˆ¶æµ

### if è¡¨è¾¾å¼

```rust
let number = 6;

if number % 4 == 0 {
    println!("divisible by 4");
} else if number % 3 == 0 {
    println!("divisible by 3");
} else {
    println!("not divisible by 3 or 4");
}

// if æ˜¯è¡¨è¾¾å¼ï¼Œå¯ä»¥èµ‹å€¼
let condition = true;
let number = if condition { 5 } else { 6 };

// åˆ†æ”¯è¿”å›å€¼ç±»å‹å¿…é¡»ç›¸åŒ
let number = if condition { 5 } else { "six" }; // é”™è¯¯!
```

### å¾ªç¯

Rust æä¾›ä¸‰ç§å¾ªç¯ï¼š`loop`ã€`while` å’Œ `for`ã€‚

#### loop å¾ªç¯

```rust
// loop æ— é™å¾ªç¯
let mut counter = 0;
let result = loop {
    counter += 1;
    if counter == 10 {
        break counter * 2; // å¯ä»¥ä»loopè¿”å›å€¼
    }
};
// result = 20

// å¾ªç¯æ ‡ç­¾ï¼šå¤„ç†åµŒå¥—å¾ªç¯
'outer: loop {
    println!("è¿›å…¥å¤–å±‚å¾ªç¯");
    'inner: loop {
        println!("è¿›å…¥å†…å±‚å¾ªç¯");
        // è¿™ä¼šä¸­æ–­å†…å±‚å¾ªç¯
        break;
        // è¿™ä¼šä¸­æ–­å¤–å±‚å¾ªç¯
        // break 'outer;
    }
    println!("å†…å±‚å¾ªç¯åçš„å¤–å±‚å¾ªç¯");
    break;
}
```

#### while æ¡ä»¶å¾ªç¯

```rust
let mut number = 3;
while number != 0 {
    println!("{}!", number);
    number -= 1;
}
println!("èµ·é£!");
```

#### for å¾ªç¯

```rust
// éå†æ•°ç»„
let arr = [10, 20, 30, 40, 50];
for element in arr {
    println!("å€¼æ˜¯: {}", element);
}

// èŒƒå›´å¾ªç¯
for number in 1..4 {     // ä¸åŒ…å«ä¸Šé™
    println!("{}!", number); // æ‰“å° 1, 2, 3
}

for number in 1..=4 {    // åŒ…å«ä¸Šé™
    println!("{}!", number); // æ‰“å° 1, 2, 3, 4
}

// åå‘èŒƒå›´
for number in (1..4).rev() {
    println!("{}!", number); // æ‰“å° 3, 2, 1
}
```

## 1.5 æ³¨é‡Šä¸æ–‡æ¡£

```rust
// è¿™æ˜¯å•è¡Œæ³¨é‡Š

/*
è¿™æ˜¯å—æ³¨é‡Šï¼Œ
å¯ä»¥è·¨è¶Šå¤šè¡Œ
*/

/// è¿™æ˜¯æ–‡æ¡£æ³¨é‡Šï¼Œç”¨äºç”Ÿæˆæ–‡æ¡£
/// # ä¾‹å­
/// ```
/// let five = 5;
/// ```
fn documented_function() {
    // å‡½æ•°å®ç°
}

//! è¿™ç§æ–‡æ¡£æ³¨é‡Šé€šå¸¸ç”¨åœ¨æ¨¡å—æˆ–crateçš„æ ¹éƒ¨ï¼Œ
//! ç”¨äºæè¿°æ•´ä¸ªæ¨¡å—æˆ–crate
```

## 1.6 åŸºæœ¬è¾“å…¥è¾“å‡º

```rust
// è¾“å‡º
println!("Hello, world!");  // å¸¦æ¢è¡Œ
print!("No newline here");  // ä¸å¸¦æ¢è¡Œ

// æ ¼å¼åŒ–è¾“å‡º
println!("My name is {} and I'm {} years old", "Alice", 30);
println!("åè¿›åˆ¶: {}, åå…­è¿›åˆ¶: {:x}, äºŒè¿›åˆ¶: {:b}", 10, 10, 10);

// å‘½åå‚æ•°
println!("{name} is {age} years old", name="Bob", age=25);

// è°ƒè¯•æ ¼å¼
println!("è°ƒè¯•è¾“å‡º: {:?}", (1, 2, "hello"));
println!("ç¾åŒ–è°ƒè¯•è¾“å‡º: {:#?}", vec![1, 2, 3]);

// è¾“å…¥
use std::io;

fn read_input() -> io::Result<String> {
    let mut input = String::new();
    io::stdin().read_line(&mut input)?;
    Ok(input.trim().to_string())
}
```
